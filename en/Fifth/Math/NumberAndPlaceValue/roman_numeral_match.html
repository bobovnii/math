<!DOCTYPE html>
<!-- Roman numeral matching using 6-button multiple choice template. -->
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
<title>Roman Numeral Match</title>
<link rel="stylesheet" href="../../../../templates/template_6buttons.css" />
<script>
  const ROMAN_MAP = [
    { value: 1000, numeral: 'M' },
    { value: 900, numeral: 'CM' },
    { value: 500, numeral: 'D' },
    { value: 400, numeral: 'CD' },
    { value: 100, numeral: 'C' },
    { value: 90, numeral: 'XC' },
    { value: 50, numeral: 'L' },
    { value: 40, numeral: 'XL' },
    { value: 10, numeral: 'X' },
    { value: 9, numeral: 'IX' },
    { value: 5, numeral: 'V' },
    { value: 4, numeral: 'IV' },
    { value: 1, numeral: 'I' }
  ];

  function toRoman(n){
    let num = n;
    let out = '';
    for(const { value, numeral } of ROMAN_MAP){
      while(num >= value){
        out += numeral;
        num -= value;
      }
    }
    return out;
  }

  function fromRoman(roman){
    let i = 0, total = 0;
    const s = roman.toUpperCase();
    const map = {I:1,V:5,X:10,L:50,C:100,D:500,M:1000};
    while(i < s.length){
      const current = map[s[i]];
      const next = map[s[i+1]] || 0;
      if(next > current){
        total += next - current;
        i += 2;
      } else {
        total += current;
        i += 1;
      }
    }
    return total;
  }

  function buildQuestion(){
    const mode = Math.random() < 0.5 ? 'roman-to-number' : 'number-to-roman';
    const number = Math.floor(Math.random()*1_500) + 200; // 200-1699
    const roman = toRoman(number);
    if(mode === 'roman-to-number'){
      const options = new Set([number, number + 10, number - 10, number + 100, number - 100, number + 50].map(n => Math.max(1,n)));
      const shuffled = Array.from(options).slice(0,6).sort(() => Math.random() - 0.5).map(n => n.toString());
      return {
        prompt: `What number does ${roman} represent?`,
        instruction: 'Match the Roman numeral to its value.',
        options: shuffled,
        correctIndex: shuffled.indexOf(String(number))
      };
    }
    const options = new Set([roman]);
    while(options.size < 6){
      const offset = (Math.floor(Math.random()*3)+1) * (Math.random() < 0.5 ? -10 : 10);
      const candidate = Math.max(1, Math.min(3999, number + offset));
      options.add(toRoman(candidate));
    }
    const final = Array.from(options).sort(() => Math.random() - 0.5);
    return {
      prompt: `Which Roman numeral equals ${number}?`,
      instruction: 'Choose the matching Roman numeral.',
      options: final,
      correctIndex: final.indexOf(roman)
    };
  }

  window.QUIZ_CONFIG = {
    title: 'Roman Numeral Match',
    randomizeQuestions: true,
    randomizeOptions: true,
    questions: Array.from({ length: 12 }, buildQuestion)
  };
</script>
<script src="../../../../templates/template_6buttons.js"></script>
</head>
<body>
  <div id="scene">
    <div id="flash" class="flash"></div>
    <div class="app">
      <header class="header">
        <h1 id="title" class="title">Roman Numeral Match</h1>
      </header>

      <aside class="panel">
        <div class="question-header">
          <p id="questionPrompt" class="question-prompt"></p>
          <p id="questionInstruction" class="question-instruction"></p>
          <p id="selectedEcho" class="selected-echo placeholder">Selected answer will appear here.</p>
        </div>
        <div class="panel-footer">
          <div id="panelFoot" class="panel-foot-text">Tap the matching value.</div>
          <button id="checkBtn" type="button" class="check-btn">Check</button>
        </div>
      </aside>

      <section id="answers" class="answers"></section>
    </div>
  </div>
</body>
</html>
